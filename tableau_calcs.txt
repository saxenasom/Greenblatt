Month Selector
((DATEDIFF('month',[Month],[Proxy])<=12) AND (DATEDIFF('month',[Month],[Proxy])>=0))

Row Selector
{FIXED [Symbol] : SUM(if [Proxy] = [Month] THEN [Row Number] ELSE NULL END)}

Portfolio Selector (filter for true)
[Row Selector]=0
OR
([Row Selector]<=[Portfolio Size]*[Portfolio Rank] 
AND 
[Row Selector]>[Portfolio Size]*([Portfolio Rank]-1))

Final
IF [Symbol]='NIFTY'
THEN [Price]*100/{FIXED [Symbol]:SUM(IF [Month]=[Proxy] THEN [Price] ELSE NULL END)}
ELSE [Price]*5/{FIXED [Symbol]:SUM(IF [Month]=[Proxy] THEN [Price] ELSE NULL END)}
END